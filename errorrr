# Cell B: system and PyTorch info (run in Python cell)
import shutil, subprocess, sys, torch, os
print("Python:", sys.executable)
print("torch.__version__:", torch.__version__)
print("torch.version.cuda:", torch.version.cuda)
print("CUDA available in torch?:", torch.cuda.is_available())
print("torch.cuda.device_count():", torch.cuda.device_count())
print("CUDA_HOME / CUDA_PATH env:", os.getenv("CUDA_HOME"), os.getenv("CUDA_PATH"))

def which(cmd):
    p = shutil.which(cmd)
    return p if p else "<not found>"

print("nvcc:", which("nvcc"))
print("gcc:", which("gcc"))
print("g++:", which("g++"))

# print nvcc version if available
if which("nvcc") != "<not found>":
    try:
        print("nvcc --version:")
        print(subprocess.check_output(["nvcc", "--version"], stderr=subprocess.STDOUT).decode())
    except Exception as e:
        print("nvcc --version failed:", e)
